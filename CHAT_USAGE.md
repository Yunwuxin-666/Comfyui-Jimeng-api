# 豆包大语言模型使用指南

## 功能介绍

豆包大语言模型节点使用火山引擎最新的 `doubao-seed-1.6` 模型，提供强大的多模态对话能力。

### 核心特性

1. **深度思考模式**
   - `auto`：自动选择最佳模式
   - `thinking`：深度思考模式，适合复杂问题
   - `non-thinking`：快速响应模式

2. **多模态输入**
   - 支持纯文本对话
   - 支持图像理解（单张或多张）
   - 支持视频理解（自动提取关键帧）

3. **对话管理**
   - 支持上下文记忆
   - 可保存/加载对话历史
   - 支持系统提示词定制

### 模型规格

- 最大上下文长度：256k tokens
- 最大输入长度：224k tokens
- 最大思维链长度：32k tokens
- 默认输出长度：4k tokens（可配置到16k）

## 快速开始

### 1. 基础文本对话

最简单的使用方式，只需输入文本问题：

```
输入：
- prompt: "解释一下什么是机器学习"
- api_key: "您的API密钥"
- thinking_mode: "auto"
```

### 2. 图像理解对话

连接图像输入，让AI理解并回答关于图像的问题：

```
输入：
- prompt: "描述这张图片的内容"
- image: [连接图像节点]
- api_key: "您的API密钥"
```

### 3. 视频理解对话

输入视频帧序列，AI会自动提取关键帧进行分析：

```
输入：
- prompt: "这个视频在讲什么？"
- video_frames: [连接视频帧节点]
- api_key: "您的API密钥"
```

### 4. 连续对话

使用对话历史管理节点维持上下文：

```
1. 使用 DoubaoLLMHistory 创建新对话
2. 将 conversation_json 连接到 DoubaoLLM
3. 每次对话后，更新的历史会从输出传递
```

## 参数详解

### 必需参数

- **prompt**: 用户的问题或指令
- **api_key**: 火山引擎API密钥
- **thinking_mode**: 思考模式选择
  - `auto`: 根据问题复杂度自动选择
  - `thinking`: 强制使用深度思考
  - `non-thinking`: 快速响应，不进行深度思考
- **temperature**: 0.0-2.0，控制回复的创造性
- **max_tokens**: 最大输出长度（1-16384）
- **stream**: 是否使用流式输出

### 可选参数

- **image**: 输入图像（IMAGE类型）
- **video_frames**: 视频帧序列（IMAGE类型）
- **system_prompt**: 系统角色设定
- **conversation_history**: JSON格式的对话历史
- **seed**: 随机种子，用于结果复现

## 输出说明

1. **response**: AI的回复内容
2. **thinking_content**: 深度思考过程（如果有）
3. **conversation_json**: 更新后的对话历史
4. **total_tokens**: 总token使用量
5. **thinking_tokens**: 思考过程使用的token数

## 最佳实践

### 1. 选择合适的思考模式

- 简单问答：使用 `non-thinking`
- 复杂推理：使用 `thinking`
- 不确定时：使用 `auto`

### 2. 图像输入优化

- 确保图像清晰度足够
- 对于多图对比，使用明确的描述
- 图像大小会自动调整，无需预处理

### 3. 视频理解技巧

- 系统会自动采样最多8个关键帧
- 对于长视频，建议先剪辑关键片段
- 可以配合文字说明提高理解准确度

### 4. 对话历史管理

- 定期保存重要对话
- 长对话建议适时清理早期内容
- 可以预设不同的系统提示词模板

## 示例工作流

### 示例1：图像描述助手

1. LoadImage → 加载图片
2. DoubaoLLM → 设置prompt为"详细描述这张图片"
3. PreviewText → 显示AI回复

### 示例2：视频分析专家

1. LoadVideo → 加载视频
2. GetVideoFrames → 提取帧
3. DoubaoLLM → 分析视频内容
4. SaveText → 保存分析结果

### 示例3：持续对话助手

1. DoubaoLLMHistory → 创建新对话
2. DoubaoLLM → 第一轮对话
3. DoubaoLLM → 第二轮对话（使用上一轮的历史）
4. DoubaoLLMHistory → 保存对话记录

## 注意事项

1. **API限制**
   - TPM: 5,000,000
   - RPM: 30,000

2. **费用说明**
   - 按输入输出长度分档计费
   - 深度思考模式会产生额外的思考token费用
   - 批量场景有优惠价格

3. **性能优化**
   - 视频理解建议控制在30秒以内
   - 长文本建议分段处理
   - 可以通过temperature调整响应速度

## 常见问题

**Q: 深度思考模式什么时候使用？**
A: 适合数学推理、代码分析、复杂决策等需要步骤化思考的场景。

**Q: 视频理解的帧数限制？**
A: 系统会自动从输入的所有帧中均匀采样最多8帧。

**Q: 如何实现角色扮演？**
A: 使用system_prompt设定角色，如"你是一位专业的医生"。

**Q: 对话历史太长怎么办？**
A: 可以定期总结重要信息，清理早期对话，保留关键上下文。 